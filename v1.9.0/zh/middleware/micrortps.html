
<!DOCTYPE HTML>
<html lang="zh" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>RTPS/ROS2 Interface · PX4 v1.9.0 Developer Guide</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-versions-select/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-theme-dronecode/theme_styles.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="micrortps_throughput_test.html" />
    
    
    <link rel="prev" href="mavlink.html" />
    

    </head>
    <body>
        
    
    <!-- ##HW Add dronecode menu -->
    <div id="common_dronecode_menu">

      <div class="common_menu_logo large_version">
        <a href="https://www.dronecode.org/">
          <img src="../../gitbook/gitbook-plugin-theme-dronecode/images/dronecode_top_bar_logo_full.png" alt="Dronecode logo (large)" />
        </a>
      </div>
      <div class="common_menu_logo small_version">
        <a href="https://www.dronecode.org/">
          <img src="../../gitbook/gitbook-plugin-theme-dronecode/images/dronecode_top_bar_logo_small.png" alt="Dronecode logo (small)" />
        </a>
      </div>
      
      <div class="common_menu_options">
        
            <div class="common_dronecode_menu_item"><a href="http://px4.io/">PX4</a></div>
            <div class="common_dronecode_menu_item large_version"><a href="http://qgroundcontrol.com/">QGroundControl</a></div>
            <div class="common_dronecode_menu_item small_version"><a href="http://qgroundcontrol.com/">QGC</a></div>
            <div class="common_dronecode_menu_item"><a href="https://www.dronecode.org/sdk/">SDK</a></div>
            <div class="common_dronecode_menu_item"><a href="https://mavlink.io/en/">MAVLink</a></div>
            <div class="common_dronecode_menu_item large_version"><a href="https://www.dronecode.org/documentation/">Documentation</a></div>
            <div class="common_dronecode_menu_item small_version"><a href="https://www.dronecode.org/documentation/">Docs</a></div>
            <div class="common_dronecode_menu_item large_version"><a href="http://discuss.px4.io/">Support</a></div>
            <div class="common_dronecode_menu_item small_version"><a href="http://discuss.px4.io/">Help</a></div>
        
      </div>
    </div>
    
<!-- ##HW END Add dronecode menu -->
    
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="輸入並搜尋" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    项目介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../setup/getting_started.html">
            
                <a href="../setup/getting_started.html">
            
                    
                    新手上路
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../setup/config_initial.html">
            
                <a href="../setup/config_initial.html">
            
                    
                    初始设置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../setup/dev_env.html">
            
                <a href="../setup/dev_env.html">
            
                    
                    安装工具链
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../setup/dev_env_mac.html">
            
                <a href="../setup/dev_env_mac.html">
            
                    
                    Mac OS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../setup/dev_env_linux.html">
            
                <a href="../setup/dev_env_linux.html">
            
                    
                    Linux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.2.1" data-path="../setup/dev_env_linux_boutique.html">
            
                <a href="../setup/dev_env_linux_boutique.html">
            
                    
                    Advanced Linux
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../setup/dev_env_windows.html">
            
                <a href="../setup/dev_env_windows.html">
            
                    
                    Windows
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../setup/fast-rtps-installation.html">
            
                <a href="../setup/fast-rtps-installation.html">
            
                    
                    Fast RTPS installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../setup/building_px4.html">
            
                <a href="../setup/building_px4.html">
            
                    
                    代码编译
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../setup/config_advanced.html">
            
                <a href="../setup/config_advanced.html">
            
                    
                    高级配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../contribute/">
            
                <a href="../contribute/">
            
                    
                    贡献&  开发者电话会议
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../contribute/git_examples.html">
            
                <a href="../contribute/git_examples.html">
            
                    
                    GIT例程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6.2" data-path="../contribute/docs.html">
            
                <a href="../contribute/docs.html">
            
                    
                    Documentation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../contribute/licenses.html">
            
                <a href="../contribute/licenses.html">
            
                    
                    Licenses
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../concept/">
            
                <a href="../concept/">
            
                    
                    概念解读
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../concept/flight_modes.html">
            
                <a href="../concept/flight_modes.html">
            
                    
                    飞行模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../concept/architecture.html">
            
                <a href="../concept/architecture.html">
            
                    
                    结构概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../concept/flight_stack.html">
            
                <a href="../concept/flight_stack.html">
            
                    
                    飞行控制栈
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../concept/middleware.html">
            
                <a href="../concept/middleware.html">
            
                    
                    中间件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../concept/mixing.html">
            
                <a href="../concept/mixing.html">
            
                    
                    混控和执行器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../concept/pwm_limit.html">
            
                <a href="../concept/pwm_limit.html">
            
                    
                    PWM限制状态机
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../hardware/">
            
                <a href="../hardware/">
            
                    
                    Hardware
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../flight_controller/">
            
                <a href="../flight_controller/">
            
                    
                    自驾仪硬件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" >
            
                <a target="_blank" href="https://dev.px4.io/en/debug/porting-guide.html">
            
                    
                    Porting Guide
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../airframes/">
            
                <a href="../airframes/">
            
                    
                    机型
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../airframes/architecture.html">
            
                <a href="../airframes/architecture.html">
            
                    
                    统一的基础代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../airframes/airframe_reference.html">
            
                <a href="../airframes/airframe_reference.html">
            
                    
                    参考机型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../airframes/adding_a_new_frame.html">
            
                <a href="../airframes/adding_a_new_frame.html">
            
                    
                    添加一个新的机型
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../data_links/">
            
                <a href="../data_links/">
            
                    
                    Data Links
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../data_links/sik_radio.html">
            
                <a href="../data_links/sik_radio.html">
            
                    
                    SiK Radio
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../advanced/telemetry_wifi.html">
            
                <a href="../advanced/telemetry_wifi.html">
            
                    
                    Wifi数传
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="../tutorials/telemetry.html">
            
                <a href="../tutorials/telemetry.html">
            
                    
                    数传
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../sensor_bus/">
            
                <a href="../sensor_bus/">
            
                    
                    传感器和执行机构总线
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../sensor_bus/i2c.html">
            
                <a href="../sensor_bus/i2c.html">
            
                    
                    I2C总线
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1.1" data-path="../sensor/sf1xx_lidar_setup.html">
            
                <a href="../sensor/sf1xx_lidar_setup.html">
            
                    
                    SF1XX lidar
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../uavcan/">
            
                <a href="../uavcan/">
            
                    
                    UAVCAN总线
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.2.1" data-path="../uavcan/bootloader_installation.html">
            
                <a href="../uavcan/bootloader_installation.html">
            
                    
                    UAVCAN Bootloader
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2.2" data-path="../uavcan/node_firmware.html">
            
                <a href="../uavcan/node_firmware.html">
            
                    
                    UAVCAN固件升级
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2.3" data-path="../uavcan/node_enumeration.html">
            
                <a href="../uavcan/node_enumeration.html">
            
                    
                    UAVCAN配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2.4" data-path="../uavcan/notes.html">
            
                <a href="../uavcan/notes.html">
            
                    
                    UAVCAN 的各种笔记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4.3" data-path="../sensor_bus/uart.html">
            
                <a href="../sensor_bus/uart.html">
            
                    
                    UART
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.3.1" data-path="../sensor/uart_ulanding_radar.html">
            
                <a href="../sensor/uart_ulanding_radar.html">
            
                    
                    uLanding Radar
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4.4" data-path="../advanced/gimbal_control.html">
            
                <a href="../advanced/gimbal_control.html">
            
                    
                    设置云台控制
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../companion_computer/pixhawk_companion.html">
            
                <a href="../companion_computer/pixhawk_companion.html">
            
                    
                    协同电脑
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../simulation/">
            
                <a href="../simulation/">
            
                    
                    仿真
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../simulation/jmavsim.html">
            
                <a href="../simulation/jmavsim.html">
            
                    
                    基本仿真
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../simulation/gazebo.html">
            
                <a href="../simulation/gazebo.html">
            
                    
                    Gazebo仿真
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../simulation/hitl.html">
            
                <a href="../simulation/hitl.html">
            
                    
                    HITL仿真
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../simulation/ros_interface.html">
            
                <a href="../simulation/ros_interface.html">
            
                    
                    连接到ROS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../simulation/airsim.html">
            
                <a href="../simulation/airsim.html">
            
                    
                    AirSim仿真
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../simulation/multi-vehicle-simulation.html">
            
                <a href="../simulation/multi-vehicle-simulation.html">
            
                    
                    多机仿真
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="./">
            
                <a href="./">
            
                    
                    中间件及架构
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="uorb.html">
            
                <a href="uorb.html">
            
                    
                    uORB消息机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="uorb_graph.html">
            
                <a href="uorb_graph.html">
            
                    
                    uORB Graph
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="mavlink.html">
            
                <a href="mavlink.html">
            
                    
                    MAVLink消息机制
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.4" data-path="micrortps.html">
            
                <a href="micrortps.html">
            
                    
                    RTPS/ROS2 Interface
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.4.1" data-path="micrortps_throughput_test.html">
            
                <a href="micrortps_throughput_test.html">
            
                    
                    Throughput Test
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4.2" data-path="micrortps_manual_code_generation.html">
            
                <a href="micrortps_manual_code_generation.html">
            
                    
                    Manually Generate Client/Agent
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../advanced/architecture_daemon.html">
            
                <a href="../advanced/architecture_daemon.html">
            
                    
                    守护程序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="drivers.html">
            
                <a href="drivers.html">
            
                    
                    驱动框架
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="modules_main.html">
            
                <a href="modules_main.html">
            
                    
                    模块 & 命令
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="modules_command.html">
            
                <a href="modules_command.html">
            
                    
                    命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="modules_communication.html">
            
                <a href="modules_communication.html">
            
                    
                    通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="modules_driver.html">
            
                <a href="modules_driver.html">
            
                    
                    驱动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="modules_system.html">
            
                <a href="modules_system.html">
            
                    
                    系统
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../robotics/">
            
                <a href="../robotics/">
            
                    
                    Robotics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../ros/offboard_control.html">
            
                <a href="../ros/offboard_control.html">
            
                    
                    用Linux进行外部控制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../ros/">
            
                <a href="../ros/">
            
                    
                    ROS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" data-path="../ros/raspberrypi_installation.html">
            
                <a href="../ros/raspberrypi_installation.html">
            
                    
                    在RPi上安装ROS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2" data-path="../ros/mavros_installation.html">
            
                <a href="../ros/mavros_installation.html">
            
                    
                    MAVROS (ROS上的MAVLink)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.3" data-path="../ros/mavros_offboard.html">
            
                <a href="../ros/mavros_offboard.html">
            
                    
                    MAVROS外部控制例程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.4" data-path="../ros/external_position_estimation.html">
            
                <a href="../ros/external_position_estimation.html">
            
                    
                    外部位置估计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.5" data-path="../simulation/gazebo_octomap.html">
            
                <a href="../simulation/gazebo_octomap.html">
            
                    
                    Gazebo Octomap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../robotics/dronekit.html">
            
                <a href="../robotics/dronekit.html">
            
                    
                    DroneKit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../debug/">
            
                <a href="../debug/">
            
                    
                    Debugging/Logging
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../debug/faq.html">
            
                <a href="../debug/faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../debug/system_console.html">
            
                <a href="../debug/system_console.html">
            
                    
                    系统控制台
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../debug/gdb_debugging.html">
            
                <a href="../debug/gdb_debugging.html">
            
                    
                    自驾仪调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../debug/sensor_uorb_topic_debugging.html">
            
                <a href="../debug/sensor_uorb_topic_debugging.html">
            
                    
                    Sensor/Topic Debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../debug/simulation_debugging.html">
            
                <a href="../debug/simulation_debugging.html">
            
                    
                    仿真调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../debug/system_wide_replay.html">
            
                <a href="../debug/system_wide_replay.html">
            
                    
                    System-wide Replay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="../debug/debug_values.html">
            
                <a href="../debug/debug_values.html">
            
                    
                    发送调试的值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="../debug/profiling.html">
            
                <a href="../debug/profiling.html">
            
                    
                    Profiling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="../log/logging.html">
            
                <a href="../log/logging.html">
            
                    
                    日志记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="../log/flight_log_analysis.html">
            
                <a href="../log/flight_log_analysis.html">
            
                    
                    飞行日志分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11" data-path="../log/ulog_file_format.html">
            
                <a href="../log/ulog_file_format.html">
            
                    
                    ULog文件格式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../tutorials/tutorials.html">
            
                <a href="../tutorials/tutorials.html">
            
                    
                    教程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../qgc/">
            
                <a href="../qgc/">
            
                    
                    地面站
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../tutorials/tutorial_hello_sky.html">
            
                <a href="../tutorials/tutorial_hello_sky.html">
            
                    
                    编写应用程序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../qgc/video_streaming.html">
            
                <a href="../qgc/video_streaming.html">
            
                    
                    QGC的视频流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../qgc/video_streaming_wifi_broadcast.html">
            
                <a href="../qgc/video_streaming_wifi_broadcast.html">
            
                    
                    远距离视频流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../tutorials/rtk-gps.html">
            
                <a href="../tutorials/rtk-gps.html">
            
                    
                    u-blox M8P RTK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="../tutorials/tuning_the_ecl_ekf.html">
            
                <a href="../tutorials/tuning_the_ecl_ekf.html">
            
                    
                    ecl EKF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="../tutorials/pre_flight_checks.html">
            
                <a href="../tutorials/pre_flight_checks.html">
            
                    
                    飞行前检查
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="../tutorials/land_detector.html">
            
                <a href="../tutorials/land_detector.html">
            
                    
                    着陆检测
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="../tutorials/linux_sbus.html">
            
                <a href="../tutorials/linux_sbus.html">
            
                    
                    Linux系统下使用S.Bus驱动
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../advanced/">
            
                <a href="../advanced/">
            
                    
                    Advanced Topics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../concept/system_startup.html">
            
                <a href="../concept/system_startup.html">
            
                    
                    系统启动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../advanced/parameters_and_configurations.html">
            
                <a href="../advanced/parameters_and_configurations.html">
            
                    
                    参数&配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../advanced/parameter_reference.html">
            
                <a href="../advanced/parameter_reference.html">
            
                    
                    参考参数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../advanced/realsense_intel_driver.html">
            
                <a href="../advanced/realsense_intel_driver.html">
            
                    
                    安装Intel RealSense R200的驱动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="../advanced/switching_state_estimators.html">
            
                <a href="../advanced/switching_state_estimators.html">
            
                    
                    切换状态估计器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="../advanced/out_of_tree_modules.html">
            
                <a href="../advanced/out_of_tree_modules.html">
            
                    
                    外部模块
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7" data-path="../software_update/stm32_bootloader.html">
            
                <a href="../software_update/stm32_bootloader.html">
            
                    
                    STM32 Bootloader
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../test_and_ci/">
            
                <a href="../test_and_ci/">
            
                    
                    测试和持续集成
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" >
            
                <a target="_blank" href="https://dev.px4.io/en/test_and_ci/unit_tests.html">
            
                    
                    Unit Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../test_and_ci/continous_integration.html">
            
                <a href="../test_and_ci/continous_integration.html">
            
                    
                    持续集成
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../test_and_ci/jenkins_ci.html">
            
                <a href="../test_and_ci/jenkins_ci.html">
            
                    
                    Jenkins持续集成环境
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="../test_and_ci/integration_testing.html">
            
                <a href="../test_and_ci/integration_testing.html">
            
                    
                    综合测试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="../test_and_ci/docker.html">
            
                <a href="../test_and_ci/docker.html">
            
                    
                    Docker容器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="../test_and_ci/maintenance.html">
            
                <a href="../test_and_ci/maintenance.html">
            
                    
                    维护
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Dronecode Shortcuts</li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <a target="_blank" href="https://docs.px4.io/en/">
            
                    
                    PX4用户指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" >
            
                <a target="_blank" href="https://docs.qgroundcontrol.com/en/">
            
                    
                    QGroundControl用户指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" >
            
                <a target="_blank" href="https://dev.qgroundcontrol.com/en/">
            
                    
                    QGroundControl开发指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" >
            
                <a target="_blank" href="https://mavlink.io/en/">
            
                    
                    MAVLink开发指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" >
            
                <a target="_blank" href="https://sdk.dronecode.org/en/">
            
                    
                    Dronecode SDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" >
            
                <a target="_blank" href="https://camera-manager.dronecode.org/en/">
            
                    
                    Dronecode Camera Manager
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本書使用 GitBook 釋出
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >RTPS/ROS2 Interface</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="rtpsros2-interface-px4-fastrtps-bridge"><a name="rtpsros2-interface-px4-fastrtps-bridge" class="plugin-anchor" href="#rtpsros2-interface-px4-fastrtps-bridge"><i class="fa fa-link" aria-hidden="true"></i></a>RTPS/ROS2 Interface: PX4-FastRTPS Bridge</h1>
<p>The <em>PX4-FastRTPS Bridge</em> adds a Real Time Publish Subscribe (RTPS) interface to PX4, enabling the exchange of <a href="uorb.html">uORB messages</a> between PX4 components and (offboard) <em>FastRTPS</em> applications.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> RTPS is the underlying protocol of the Object Management Group&apos;s (OMG) Data Distribution Service (DDS) standard. It aims to enable scalable, real-time, dependable, high-performance and interoperable data communication using the publish/subscribe pattern. <em>FastRTPS</em> is a very lightweight cross-platform implementation of the latest version of the RTPS protocol and a minimum DDS API.</p>
</blockquote>
<p>RTPS has been adopted as the middleware for the ROS2 (Robot Operating System). The bridge allows us to better integrate with ROS2, making it easy to share sensor values, commands, and other vehicle information.</p>
<p>This topic describes the bridge architecture, how it is compiled, and how to write a simple FastRTSP application to subscribe to PX4 changes.</p>
<h2 id="when-should-rtps-be-used"><a name="when-should-rtps-be-used" class="plugin-anchor" href="#when-should-rtps-be-used"><i class="fa fa-link" aria-hidden="true"></i></a>When should RTPS be used?</h2>
<p>RTPS should be used in circumstances where there is a need to reliably share time-critical/real-time information between the flight controller and off board components. In particular it is useful in cases where off-board software needs to become a peer software component running in PX4 (by sending and receiving uORB topics).</p>
<p>Possible use cases include communicating with robotics libraries for computer vision, and other use cases where real time data to/from actuators and sensors is essential for vehicle control. </p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> FastRTPS is not intended as a replacement for MAVLink. MAVLink remains the most appropriate protocol for communicating with ground stations, gimbals, cameras, etc. (although FastRTPS may open other opportunities for working with some peripherals).</p>
</blockquote>
<p><span></span></p>
<blockquote class="clearfix alert alert-success"><strong class="fa fa-2x fa-thumbs-o-up"></strong>
<p> RTPS can be used over slower links (e.g. like radio telemetry, but care should be taken not to overload the channel. </p>
</blockquote>
<h2 id="architectural-overview"><a name="architectural-overview" class="plugin-anchor" href="#architectural-overview"><i class="fa fa-link" aria-hidden="true"></i></a>Architectural overview</h2>
<p><img src="../../assets/middleware/micrortps/architecture.png" alt="basic example flow"></p>
<p>The main elements of the architecture are the client and agent processes shown in the diagram above.</p>
<ul>
<li>The <em>Client</em> is PX4 middleware daemon process that runs on the flight controller. It subscribes to uORB topics published by other PX4 components and sends any updates to the <em>Agent</em> (via a UART or UDP port). It also receives messages from the <em>Agent</em> and publishes them as uORB message on PX4.</li>
<li>The <em>Agent</em> runs as a daemon process on an offboard computer. It watches for uORB update messages from the <em>Client</em> and (re)publishes them over RTPS. It also subscribes to &quot;uORB&quot; RTPS messages from other RTPS applications and forwards them to the <em>Client</em>.</li>
<li>The <em>Agent</em> and <em>Client</em> are connected via a serial link (UART) or UDP network. The uORB information is <a href="https://en.wikipedia.org/wiki/Common_Data_Representation" target="_blank">CDR serialized</a> for sending (<em>CDR serialization</em> provides a common format for exchanging serial data between different platforms).</li>
<li>The <em>Agent</em> and any <em>FastRTPS</em> applications are connected via UDP, and may be on the same or another device. In a typical configuration they will both be on the same system (e.g. a development computer, Linux companion computer or compute board), connected to the <em>Client</em> over a Wifi link or via USB.</li>
</ul>
<h2 id="code-generation"><a name="code-generation" class="plugin-anchor" href="#code-generation"><i class="fa fa-link" aria-hidden="true"></i></a>Code generation</h2>
<p>All the code needed to create, build and use the bridge is automatically generated when the PX4 Firmware is compiled. </p>
<p>The <em>Client</em> application is also compiled and built into the firmware as part of the normal build process. The <em>Agent</em> must be separately/manually compiled for the target computer.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> <a href="../setup/fast-rtps-installation.html">Fast RTPS must be installed</a> in order to generate the required code!</p>
</blockquote>
<p><span></span></p>
<blockquote class="clearfix alert alert-success"><strong class="fa fa-2x fa-thumbs-o-up"></strong>
<p> The bridge code can also be <a href="micrortps_manual_code_generation.html">manually generated</a>. Most users will not need to do so, but the linked topic provides a more detailed overview of the build process and can be useful for troubleshooting.</p>
</blockquote>
<h2 id="supported-uorb-messages"><a name="supported-uorb-messages" class="plugin-anchor" href="#supported-uorb-messages"><i class="fa fa-link" aria-hidden="true"></i></a>Supported uORB messages</h2>
<p>The generated bridge code will enable a specified subset of uORB topics to be published/subscribed via RTPS.</p>
<p>For <em>automatic code generation</em> (via the normal PX4 firmware build process) this set must be listed in the <strong>/path/to/PX4/Firmware/src/modules/micrortps_bridge/CMakeLists.txt</strong> file.</p>
<pre><code class="lang-cmake"><span class="hljs-keyword">set</span>(config_rtps_send_topics
  sensor_combined
   <span class="hljs-comment"># Add new topic...</span>
   )

<span class="hljs-keyword">set</span>(config_rtps_receive_topics
   sensor_baro
   <span class="hljs-comment"># Add new topic...</span>
   )
</code></pre>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> At time of writing (August 2017), only the small set of uORB topics listed above are included in our cmake files: <strong>PX4/Firmware/boards/px4/sitl/default.cmake</strong>, <strong>PX4/Firmware/boards/px4/fmu-v4/default.cmake</strong>, <strong>posix_sdflight_default.cmake</strong>. It is likely you will need to edit your <em>cmake</em> file and add additional uORB topics. In future we hope to define a larger standard set. </p>
</blockquote>
<p>For <em>manual code generation</em> the uORB topics that will be supported by the bridge are specified when you call <strong>generate_microRTPS_bridge.py</strong> (using the <code>-s</code>/<code>--send</code> and <code>-r</code>/<code>--receive</code> flags). See <a href="micrortps_manual_code_generation.html">Manual Generation of the Code</a> for more information.</p>
<h2 id="client-px4-firmware"><a name="client-px4-firmware" class="plugin-anchor" href="#client-px4-firmware"><i class="fa fa-link" aria-hidden="true"></i></a>Client (PX4 Firmware)</h2>
<p>The <em>Client</em> source code is generated, compiled and built into the PX4 firmware as part of the normal build process. </p>
<p>To build and upload the firmware for NuttX/Pixhawk flight controllers:</p>
<pre><code class="lang-sh">make px4_fmu-v4_default upload
</code></pre>
<p>To build and upload the firmware for Qualcomm Snapdragon Flight:</p>
<pre><code class="lang-sh">$ make eagle_default upload
</code></pre>
<p>The <em>Client</em> application can be launched from <a href="../debug/system_console.html">NuttShell/System Console</a>. The command syntax is shown below (you can specify a variable number of arguments):</p>
<pre><code class="lang-sh">&gt; micrortps_client start|stop [options]
  -t &lt;transport&gt;          [UART|UDP] Default UART
  <span class="hljs-_">-d</span> &lt;device&gt;             UART device. Default /dev/ttyACM0
  -u &lt;update_time_ms&gt;     Time <span class="hljs-keyword">in</span> ms <span class="hljs-keyword">for</span> uORB subscribed topics update. Default 0
  <span class="hljs-_">-l</span> &lt;loops&gt;              How many iterations will this program have. -1 <span class="hljs-keyword">for</span> infinite. Default -1.
  -w &lt;sleep_time_ms&gt;      Time <span class="hljs-keyword">in</span> ms <span class="hljs-keyword">for</span> <span class="hljs-built_in">which</span> each iteration sleep. Default 1ms
  -b &lt;baudrate&gt;           UART device baudrate. Default 460800
  -p &lt;poll_ms&gt;            Time <span class="hljs-keyword">in</span> ms to poll over UART. Default 1ms
  -r &lt;reception port&gt;     UDP port <span class="hljs-keyword">for</span> receiving. Default 2019
  <span class="hljs-_">-s</span> &lt;sending port&gt;       UDP port <span class="hljs-keyword">for</span> sending. Default 2020
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> By default the <em>Client</em> runs as a daemon, but you will need to start it manually. The PX4 Firmware initialisation code may in future automatically start the <em>Client</em> as a permanent daemon process.<!-- at that point, most of this section would move into the "manual generation" doc: https://github.com/PX4/Firmware/pull/7663#issuecomment-317928506 --></p>
</blockquote>
<h2 id="agent-off-board-fastrtps-interface"><a name="agent-off-board-fastrtps-interface" class="plugin-anchor" href="#agent-off-board-fastrtps-interface"><i class="fa fa-link" aria-hidden="true"></i></a>Agent (Off Board FastRTPS Interface)</h2>
<p>The <em>Agent</em> code is automatically <em>generated</em> when you build the associated PX4 firmware. You can find the source here: <strong>build/<target-platform>/src/modules/micrortps_bridge/micrortps_client/micrortps_agent/</target-platform></strong>.</p>
<p>To build the <em>Agent</em> application, compile the code:</p>
<pre><code class="lang-sh"><span class="hljs-built_in">cd</span> build/&lt;target-platform&gt;/src/modules/micrortps_bridge/micrortps_client/micrortps_agent
mkdir build &amp;&amp; <span class="hljs-built_in">cd</span> build
cmake ..
make
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> To cross-compile for the <em>Qualcomm Snapdragon Flight</em> platform see <a href="https://github.com/eProsima/PX4-FastRTPS-PoC-Snapdragon-UDP#how-to-use" target="_blank">this link</a>.</p>
</blockquote>
<p>The command syntax for the <em>Agent</em> is listed below:</p>
<pre><code class="lang-text">$ ./micrortps_agent [options]
  -t &lt;transport&gt;          [UART|UDP] Default UART.
  -d &lt;device&gt;             UART device. Default /dev/ttyACM0.
  -w &lt;sleep_time_us&gt;      Time in us for which each iteration sleep. Default 1ms.
  -b &lt;baudrate&gt;           UART device baudrate. Default 460800.
  -p &lt;poll_ms&gt;            Time in ms to poll over UART. Default 1ms.
  -r &lt;reception port&gt;     UDP port for receiving. Default 2019.
  -s &lt;sending port&gt;       UDP port for sending. Default 2020.
</code></pre>
<p>To launch the <em>Agent</em>, run <code>micrortps_agent</code> with appropriate options for specifying the connection to the <em>Client</em> (the default options connect from a Linux device to the <em>Client</em> over a UART port).</p>
<h2 id="creating-a-fastrtps-listener-application"><a name="creating-a-fastrtps-listener-application" class="plugin-anchor" href="#creating-a-fastrtps-listener-application"><i class="fa fa-link" aria-hidden="true"></i></a>Creating a FastRTPS Listener application</h2>
<p>Once the <em>Client</em> (on the flight controller) and the <em>Agent</em> (on an offboard computer) are running and connected, <em>FastRTPS</em> applications can publish and subscribe to uORB topics on PX4 using RTPS. </p>
<p>This example shows how to create a <em>FastRTPS</em> &quot;listener&quot; application that subscribes to the <code>sensor_combined</code> topic and prints out updates (from PX4). A connected RTPS application can run on any computer on the same network as the <em>Agent</em>. For this example the <em>Agent</em> and <em>Listener application</em> will be on the same computer.</p>
<p>The <em>fastrtpsgen</em> script can be used to generate a simple RTPS application from an IDL message file. </p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> RTPS messages are defined in IDL files and compiled to C++ using <em>fastrtpsgen</em>. As part of building the bridge code, IDL files are generated for the uORB message files that may be sent/received (see <strong>build/BUILDPLATFORM/src/modules/micrortps_bridge/micrortps_agent/idl/*.idl</strong>). These IDL files are needed when you create a FastRTPS application to communicate with PX4.</p>
</blockquote>
<p>Enter the following commands to create the application:</p>
<pre><code class="lang-sh"><span class="hljs-built_in">cd</span> /path/to/PX4/Firmware/src/modules/micrortps_bridge
mkdir micrortps_listener
<span class="hljs-built_in">cd</span> micrortps_listener
fastrtpsgen -example x64Linux2.6gcc ../micrortps_agent/idl/sensor_combined_.idl
</code></pre>
<p>This creates a basic subscriber and publisher, and a main-application to run them. To print out the data from the <code>sensor_combined</code> topic, modify the <code>onNewDataMessage()</code> method in <strong>sensor_combined_Subscriber.cxx</strong>:</p>
<pre><code class="lang-sh">void sensor_combined_Subscriber::SubListener::onNewDataMessage(Subscriber* sub)
{
    // Take data
    sensor_combined_ st;

    <span class="hljs-keyword">if</span>(sub-&gt;takeNextData(&amp;st, &amp;m_info))
    {
        <span class="hljs-keyword">if</span>(m_info.sampleKind == ALIVE)
        {
            // Print your structure data here.
            ++n_msg;
            std::cout &lt;&lt; <span class="hljs-string">&quot;\n\n\n\n\n\n\n\n\n\n&quot;</span>;
            std::cout &lt;&lt; <span class="hljs-string">&quot;Sample received, count=&quot;</span> &lt;&lt; n_msg &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;=============================&quot;</span> &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;gyro_rad: &quot;</span> &lt;&lt; st.gyro_rad().at(0);
            std::cout &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; st.gyro_rad().at(1);
            std::cout &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; st.gyro_rad().at(2) &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;gyro_integral_dt: &quot;</span> &lt;&lt; st.gyro_integral_dt() &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;accelerometer_timestamp_relative: &quot;</span> &lt;&lt; st.accelerometer_timestamp_relative() &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;accelerometer_m_s2: &quot;</span> &lt;&lt; st.accelerometer_m_s2().at(0);
            std::cout &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; st.accelerometer_m_s2().at(1);
            std::cout &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; st.accelerometer_m_s2().at(2) &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;accelerometer_integral_dt: &quot;</span> &lt;&lt; st.accelerometer_integral_dt() &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;magnetometer_timestamp_relative: &quot;</span> &lt;&lt; st.magnetometer_timestamp_relative() &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;magnetometer_ga: &quot;</span> &lt;&lt; st.magnetometer_ga().at(0);
            std::cout &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; st.magnetometer_ga().at(1);
            std::cout &lt;&lt; <span class="hljs-string">&quot;, &quot;</span> &lt;&lt; st.magnetometer_ga().at(2) &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;baro_timestamp_relative: &quot;</span> &lt;&lt; st.baro_timestamp_relative() &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;baro_alt_meter: &quot;</span> &lt;&lt; st.baro_alt_meter() &lt;&lt; std::endl;
            std::cout &lt;&lt; <span class="hljs-string">&quot;baro_temp_celcius: &quot;</span> &lt;&lt; st.baro_temp_celcius() &lt;&lt; std::endl;

        }
    }
}
</code></pre>
<p>To build and run the application on Linux:</p>
<pre><code class="lang-sh">make <span class="hljs-_">-f</span> makefile_x64Linux2.6gcc
bin/*/sensor_combined_PublisherSubscriber subscriber
</code></pre>
<p>Now you should see the sensor information being printed out:</p>
<pre><code class="lang-sh">Sample received, count=10119
Received sensor_combined data
=============================
gyro_rad: -0.0103228, 0.0140477, 0.000319406
gyro_integral_dt: 0.004
accelerometer_timestamp_relative: 0
accelerometer_m_s2: -2.82708, -6.34799, -7.41101
accelerometer_integral_dt: 0.004
magnetometer_timestamp_relative: -10210
magnetometer_ga: 0.60171, 0.0405879, -0.040995
baro_timestamp_relative: -17469
baro_alt_meter: 368.647
baro_temp_celcius: 43.93
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> If the <em>Listener application</em> does not print anything, make sure the <em>Client</em> is running.</p>
</blockquote>
<h2 id="examplestests"><a name="examplestests" class="plugin-anchor" href="#examplestests"><i class="fa fa-link" aria-hidden="true"></i></a>Examples/tests</h2>
<p>The following examples provide additional real-world demonstrations of how to use the features described in this topic.</p>
<ul>
<li><a href="micrortps_throughput_test.html">Throughput test</a>: A simple test to measure the throughput of the bridge.</li>
</ul>
<h2 id="troubleshooting"><a name="troubleshooting" class="plugin-anchor" href="#troubleshooting"><i class="fa fa-link" aria-hidden="true"></i></a>Troubleshooting</h2>
<h3 id="client-reports-that-selected-uart-port-is-busy"><a name="client-reports-that-selected-uart-port-is-busy" class="plugin-anchor" href="#client-reports-that-selected-uart-port-is-busy"><i class="fa fa-link" aria-hidden="true"></i></a>Client reports that selected UART port is busy</h3>
<p>If the selected UART port is busy, it&apos;s possible that the MAVLink application is already being used. If both MAVLink and RTPS connections are required you will have to either move the connection to use another port or configure the port so that it can be shared. <!-- https://github.com/PX4/Devguide/issues/233 --></p>
<blockquote class="clearfix alert alert-success"><strong class="fa fa-2x fa-thumbs-o-up"></strong>
<p> A quick/temporary fix to allow bridge testing during development is to stop MAVLink from <em>NuttShell</em>:</p>
<pre><code class="lang-sh">  mavlink stop-all
</code></pre>
</blockquote>
<h3 id="agent-not-builtfastrtpsgen-is-not-found"><a name="agent-not-builtfastrtpsgen-is-not-found" class="plugin-anchor" href="#agent-not-builtfastrtpsgen-is-not-found"><i class="fa fa-link" aria-hidden="true"></i></a>Agent not built/fastrtpsgen is not found</h3>
<p>The <em>Agent</em> code is generated using a <em>FastRTPS</em> tool called <em>fastrtpsgen</em>.  </p>
<p>If you haven&apos;t installed Fast RTPS in the default path then you must specify its installation directory by setting the <code>FASTRTPSGEN_DIR</code> environment variable before executing <em>make</em>.</p>
<p>On Linux/Mac this is done as shown below:</p>
<pre><code class="lang-sh"><span class="hljs-built_in">export</span> FASTRTPSGEN_DIR=/path/to/fastrtps/install/folder/bin
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> This should not be a problem if <a href="../setup/fast-rtps-installation.html">Fast RTPS is installed in the default location</a>.</p>
</blockquote>
<h3 id="enable-uart-on-raspberry-pi"><a name="enable-uart-on-raspberry-pi" class="plugin-anchor" href="#enable-uart-on-raspberry-pi"><i class="fa fa-link" aria-hidden="true"></i></a>Enable UART on Raspberry Pi</h3>
<p>For UART transport on Raspberry Pi you will have to enable the serial port:</p>
<ol>
<li><p>Make sure the <code>userid</code> (default is pi) is a member of the <code>dialout</code> group:</p>
<pre><code class="lang-sh">groups pi
sudo usermod <span class="hljs-_">-a</span> -G dialout pi
</code></pre>
</li>
<li><p>You need to stop the GPIO serial console that is using the port:</p>
<pre><code class="lang-sh">sudo raspi-config
</code></pre>
<p>In the menu showed go to <strong>Interfacing options &gt; Serial</strong>. Select <strong>NO</strong> for <em>Would you like a login shell to be accessible over serial?</em>. Valid and reboot.</p>
</li>
<li><p>Check UART in kernel:</p>
<pre><code class="lang-sh">sudo vi /boot/config.txt
</code></pre>
<p>And make sure that the <code>enable_uart</code> value is set to 1:</p>
<pre><code class="lang-txt">enable_uart=1
</code></pre>
</li>
</ol>
<h2 id="additional-information"><a name="additional-information" class="plugin-anchor" href="#additional-information"><i class="fa fa-link" aria-hidden="true"></i></a>Additional information</h2>
<ul>
<li><a href="../setup/fast-rtps-installation.html">FastRTPS Installation</a></li>
<li><a href="micrortps_manual_code_generation.html">Manually Generate Client and Agent Code</a></li>
<li><a href="https://github.com/ros2/ros2/wiki/DDS-and-ROS-middleware-implementations" target="_blank">DDS and ROS middleware implementations</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="mavlink.html" class="navigation navigation-prev " aria-label="Previous page: MAVLink消息机制">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="micrortps_throughput_test.html" class="navigation navigation-next " aria-label="Next page: Throughput Test">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"RTPS/ROS2 Interface","level":"1.6.4","depth":2,"next":{"title":"Throughput Test","level":"1.6.4.1","depth":3,"path":"middleware/micrortps_throughput_test.md","ref":"middleware/micrortps_throughput_test.md","articles":[]},"previous":{"title":"MAVLink消息机制","level":"1.6.3","depth":2,"path":"middleware/mavlink.md","ref":"middleware/mavlink.md","articles":[]},"dir":"ltr"},"config":{"plugins":["youtube","richquotes@git+https://github.com/Dronecode/gitbook-plugin-richquotes.git","collapsible-menu","anchors","page-toc-button","ga","language-picker","custom-favicon","bulk-redirect@git+https://github.com/Dronecode/gitbook-plugin-bulk-redirect.git","toolbar@git+https://github.com/hamishwillee/gitbook-plugin-toolbar.git","validate-links","versions-select@git+https://github.com/Dronecode/gitbook-plugin-versions-select.git","mathjax@git+https://github.com/Dronecode/plugin-mathjax.git#update_cdn","mermaid","-stub-out-blocks@git+https://github.com/hamishwillee/gitbook-plugin-stub-out-blocks.git","theme-dronecode@git+https://github.com/dronecode/theme-dronecode.git"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"theme-dronecode":{"logo":{"logo_large":"gitbook-plugin-theme-dronecode/images/dronecode_top_bar_logo_full.png","logo_small":"gitbook-plugin-theme-dronecode/images/dronecode_top_bar_logo_small.png","url":"https://www.dronecode.org/"}},"validate-links":{"defaultScheme":"https","local":"warn","remote":"disabled"},"collapsible-menu":{},"language-picker":{"grid-columns":3},"youtube":{},"search":{},"mermaid":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"versions-select":{"type":"branches"},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{"tip":{"alert":"success","picto":"fa-thumbs-o-up"}},"highlight":{},"favicon":"favicon.ico","page-toc-button":{},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"custom-favicon":{},"mathjax":{"forceSVG":false,"version":"2.7.1"},"ga":{"configuration":"auto","token":"UA-33658859-3"},"versions":{"gitbookConfigURL":"https://raw.githubusercontent.com/PX4/Devguide/master/book.json","options":[{"value":"https://dev.px4.io/en/","text":"stable (v1.8.2)"},{"value":"https://dev.px4.io/master/en/","text":"master"},{"value":"https://dev.px4.io/v1.8.2/en/","text":"1.8.2"},{"value":"https://dev.px4.io/v1.8.0/en/","text":"1.8.0"}]},"toolbar":{"buttons":[{"label":"Bug tracker","icon":"fa fa-bug","position":"left","url":"https://github.com/PX4/Devguide/issues/new?title=Doc+Bug:+{{title}}&body=DESCRIBE+PROBLEM+WITH+DOCS+HERE%0A%0ABug+Page:+[{{title}}]({{url}})"},{"label":"GitHub","icon":"fa fa-github","url":"https://github.com/PX4/Devguide"},{"label":"Edit page on github","icon":"fa fa-pencil-square-o","position":"left","url":"https://github.com/PX4/Devguide/edit/master/{{filepath_lang}}"}]},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"logo":"./assets/site/logo_pro_small.png","px4_version":"v1.9.0"},"title":"PX4 v1.9.0 Developer Guide","language":"zh","gitbook":"*"},"file":{"path":"middleware/micrortps.md","mtime":"2019-05-28T02:20:35.242Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-05-28T02:22:17.119Z"},"basePath":"..","book":{"language":"zh"}});
        });
    </script>
</div>

    

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-toolbar/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-versions-select/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

